---
layout: post
title: "01 - Nuestro primer programa"
date: 2025-04-20 20:30:00 +0200
categories: arduino basic
excerpt: "La idea de esta lección es fijar algunas ideas básicas sobre programación. Tenemos que comprender la estructura de un programa arduino (sketch), debemos definir las estructuras de blogs y conocer las primeras instrucciones."
---


[img1]: /assets/images/ard/ard_01_01.jpg "Compilador"
[img2]: /assets/images/ard/ard_01_02.png "Entradas y salidas"
[img3]: /assets/images/ard/ard_01_03.png "Verificar"
[img4]: /assets/images/ard/ard_01_04.png "Cargar"

Vamos a crear nuestro primer programa.

## Objetivos

La idea de esta lección es fijar algunas ideas básicas sobre programación. Tenemos que comprender la estructura de un programa arduino (sketch), debemos definir las estructuras de blogs y conocer las primeras instrucciones.

## Algunas ideas básicas sobre programación

Un **programa de ordenador** es básicamente el equivalente a una _receta de cocina_... pero destinado a un público distinto.

Mientras que las personas somos razonablemente buenas _interpretando_ las instrucciones, generalmente vagas, de una receta de cocina, cuando programamos quien debe entendernos es un ordenador que espera instrucciones precisas respecto a lo que debe hacer y que además carece por completo de la imaginación o capacidad de improvisación humana.

Por eso se desarrollan los lenguajes de ordenador, para dar instrucciones a una máquina de forma:

- Precisa: Sin ambigüedades inherentes a la comunicación humana.
- Unívoca: Sólo se puede interpretar de una manera.
- Concisa: Preferiblemente órdenes cortas.

El IDE de Arduino se programa en una variante de C++, que es un lenguaje muy extendido por sus características, aunque no es un lenguaje sencillo. C++, que fija reglas estrictas de cómo escribir estas instrucciones.

Un programa es una serie de instrucciones que se ejecutan en secuencia (salvo que indiquemos expresamente condiciones precisas en las que esta secuencia se altera).

Un programa interno comprueba que la sintaxis de nuestro programa es conforme a la norma de C++, y si hay algo que no le convence dará un error y finalizará la comprobación obligándonos a revisar el que hemos escrito.

Cuando el comprobador acepta nuestro programa, invoca otro programa que traduce lo que hemos escrito a instrucciones comprensibles para el procesador de nuestro Arduino. A este nuevo programa se le llama compilador.

![Compilador][img1]

El compilador convierte nuestras instrucciones (código fuente) en instrucciones del procesador (código ejecutable).

## Estructura de un programa Arduino

Un programa o Sketch de Arduino consta de dos secciones o funciones básicas:

- _Setup: Las instrucciones que contiene se ejecutan sólo una vez, cuando se enciende Arduino o cuando pulsamos el botón de reset. Generalmente incluye definiciones y/o inicializaciones de los pines._
- _Loop: Las instrucciones que contiene se ejecutan en secuencia hasta que acaba, y luego vuelve a empezar desde el principio haciendo un ciclo sin fin._

Cuando abrimos el **IDE de Arduino** (o hacemos Menú\Archivo\nuevo) nos escribe ya estas dos funciones (en color cobre):

Nótese que el principio de cada función está indicado para la apertura de llave " { " y el fin de la misma corresponde al símbolo de cerrar claves " } ".

De hecho el conjunto de instrucciones contenidas entre una apertura y cierre de llaves se llama **bloque** y es de primordial importancia a la hora de que nuestro **Arduino** interprete de una u otra manera las instrucciones que le damos.

Es imperativo que a cada apertura de una llave corresponda un cierre de llave. En sucesivos capítulos ampliaremos este concepto.

Por ahora resaltar las líneas que aparecen dentro de los blogs principales:

```Arduino
// put your setup code here, to run once

// put your main code here, to run repeatedly
```

Cualquier cosa que escribamos precedido por `//` son comentarios, y serán ignorados. Es decir podemos dejarnos mensajes dentro del código, (que de una otra forma darían errores). El compilador ignorará cualquier cosa entre `//` y el fin de línea.

## Primeras instrucciones en Arduino C++

Parece obligado en el mundo **Arduino**, que el primer programa que hacemos sea el blinking LED, y está bien porque ilustra algunas ideas interesantes en cuanto a sus posibilidades:

- La capacidad de Arduino para interactuar con el mundo externo. Una  cosa bastante inusitada para quienes estén acostumbrados a la  informática tradicional, donde la potencia de cálculo ha crecido de  manera espectacular, pero sigue siendo imposible (o casi),  influir en el mundo exterior.
- La sencillez del entorno de trabajo. En contraposición a un sistema  tradicional de editor/compilador/linker.

Arduino puede relacionarse de distintas formas con el mundo que le rodea, Empezaremos por los pines digitales que pueden usarse como:

- Entradas: Para leer información digital del mundo exterior.
- Salidas: Para activar una señal en el mundo exterior.

![Entradas y salidas][img2]

Arduino dispone de 14 pins que pueden ser usados de esta forma, numerados del 0 al 13.

En la lección anterior cargamos un programa de ejemplo que hace parpadear un LED en la placa con una cadencia definida. Veamos cómo programar esto.

Pediremos a Arduino que active su pin 13 como de salida digital y después encenderemos y apagaremos esta señal lo que hará que el LED que tiene conectado de serie se encienda o apague al ritmo que marcamos.

Para indicar al sistema que deseamos usar el pin 13 como salida digital utilizamos la instrucción:

``` Arduino
pinMode ( 13, OUTPUT ) ;
```

El primer parámetro indica el pin a usar y "OUTPUT" es para usarlo como salida, y también podría usarse el valor "INPUT" para indicar que leeremos de este pin.

Estas definiciones se harán sólo una vez al principio, en la función `setup()`. La nuestra quedará en una única instrucción que declara que usaremos el pin 13 como salida digital:

``` Arduino
void setup()
{
// inicializa el pin 13 como salida digital
pinMode( 13, OUTPUT) ;
}
```

- Es importante fijarse en que a pesar de ser una única instrucción, hemos delimitado el bloque de esta función mediante abrir y cerrar llaves.
- Obsérvese que la instrucción finaliza en ";" . C++ obliga a terminar las instrucciones con un punto y coma que delimite el orden. Si se omite generará un error.

Para encender el LED utilizaremos la instrucción:

``` Arduino
digitalWrite( 13 , HIGH) ;
```

Y otra instrucción similar que le ordena apagarlo:

``` Arduino
digitalWrite( 13 , LOW) ;
```

El 13 indica el pin a utilizar y HIGH, LOW indican el valor que deseamos poner en esa salida, que en Arduino corresponden a 5V para HIGH y 0V para LOW.

- Si en la función loop() escribiésemos estas dos instrucciones  seguidas, Arduino cambiaría estos valores tan rápido que no  percibiríamos cambios, así que necesitamos frenarle un poco para que  podamos percibir el cambio.

Para hacer este retraso de, digamos, un segundo, utilizaremos:

``` Arduino
delay(1000) ; //delay(n) "congela" Arduino n milisegundos
```

Por tanto para programar una luz que se enciende y se apaga, deberíamos generar una secuencia de órdenes que hagan:

1. Informar a Arduino de que utilizaremos el pin13 para escribir valores(en el setup).
2. Encender el LED: Poner valor alto (5V) en este pin.
3. Esperar un segundo.
4. Apagar el LED: Poner valor bajo (0V) en este pin.
5. Volver a esperar un segundo.

- Si omitiéramos este segundo retraso, apagaría la luz y volvería a empezar encontrándose la orden de volver a encender. No apreciaríamos que se había apagado.(No espero que me crea. Compruébelo)._
- El procesador de Arduino UNO es muy lento desde el punto de vista electrónico, pero es capaz de conmutar la luz (pasar de encendido a apagado y vuelta a encender) unas 15.000 veces por segundo._

El primer concepto que debe fijar, es que los ordenadores procesan las órdenes en secuencia, una instrucción después de otra y en el orden en que se las da. _Nuestro programa instruye al ordenador para que ejecute esas instrucciones y fija el orden en el que se ejecutan._

La forma de escribir un programa en Arduino C++ que haga lo anteriormente descrito es algo parecido a esto :

``` Arduino

/*
 * CARTROTECH  (https://cartrotech.github.io)
 * 
 * Projecto nº: ARD_01
 * Descripcion: Primer programa en Arduino
 * 
 * Fecha: 2025-04-20
 */

void setup()
{
 pinMode( 13 , OUTPUT); // Usaremos el pin 13 como salida
}

void loop()
{
 digitalWrite(13 , HIGH); // Enciende el LED
 delay(1000); // Esperar un segundo
 digitalWrite(13 , LOW); // Apagar el LED
 delay(1000); // Esperar otro segundo
}
```

- Nótese el sangrado de las líneas para destacar los blogs de código. Esto se considera buena práctica y se lo recomendamos encarecidamente, porque facilita mucho la comprensión del programa.
- Cuando se equivoca (y créame, se equivocará) el sangrado ayuda, y mucho, a visualizar el programa.
- Sólo existen dos tipos de programadores. Los que se equivocan y los que se equivocarán

Sólo nos falta ya, comprobar si existen errores y para ello pulsamos el icono "verifica":

![Verificar][img3]

Si todo va bien, ( si no hay errores en rojo) podemos compilar y volcar con la flecha "Cargar", De lo contrario ( y créame que le pasará con frecuencia) habrá que revisar los posibles errores y corregirlos.

![Cargar][img4]

La flecha volcará nuestro programa en el Arduino y podremos comprobar que la luz del pin 13 parpadea con un retraso de un segundo entre encendido y apagado.

- Sugerencia: Si modificamos los valores del delay, modificaremos la cadencia del parpadeo.
- Nota: Esto no funcionará con ningún otro Pin del Arduino UNO, porque sólo el 13 tiene un LED conectado.

## Resumen de la lección

En esta lección hemos aprendido varias cosas importantes:

- El concepto clave de un programa, como secuencia de instrucciones que se ejecuta en el orden marcado.
- Hay dos funciones básicas en todo programa Arduino: setup() y loop().
- Para delimitar un bloque de instrucciones utilizamos apertura y cierre de llaves.
- Todas las instrucciones terminan en punto y coma (Aunque hay excepciones).
- Podemos usar comentarios usando //
- Hemos aprendido algunas instrucciones iniciales de Arduino C++.
